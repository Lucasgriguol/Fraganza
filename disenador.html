<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fraganza ‚Äî Perfumes de Dise√±ador</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <meta name="description" content="Colecci√≥n de perfumes de dise√±ador en Fraganza. Cl√°sicos y novedades." />
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>

<body>
    <div class="wrap">
        <div class="navbar-wrap">
            <div class="navbar">
                <div style="display:flex;align-items:center;gap:12px">
                    <button class="mobile-toggle icon-btn" aria-label="Abrir men√∫"
                        onclick="toggleOffcanvas()">‚ò∞</button>
                    <div class="brand">
                        <img class="logo" src="IMG-20251110-WA0007.jpg" alt="">
                        <div>
                            <h1>Fraganza</h1>
                            <p class="small">Perfumer√≠a selecta</p>
                        </div>
                    </div>
                </div>
                <div class="nav-center" role="navigation" aria-label="Navegaci√≥n principal">
                    <a class="nav-link" href="index.html">Inicio</a>
                    <a class="nav-link" href="arabes.html">Perfumes √Årabes</a>
                    <a class="nav-link" href="disenador.html">Dise√±ador</a>
                    <a class="nav-link" href="proximo.html">Pr√≥ximamente</a>
                    <a class="nav-link nav-reserva" href="reservas.html">Mis Reservas</a>
                </div>
                <div class="nav-right">
                    <div class="reserva-indicator">
                        <button class="icon-btn" aria-label="Ver reservas"
                            onclick="window.location.href='reservas.html'">üìã <span class="reserva-count"
                                id="reserva-count">0</span></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="offcanvas" id="offcanvas">
            <div class="offcanvas-content">
                <div class="offcanvas-header">
                    <h3 class="offcanvas-title">Men√∫</h3>
                    <button class="offcanvas-close" onclick="toggleOffcanvas()">‚úï</button>
                </div>
                <nav class="offcanvas-nav">
                    <a href="index.html" class="offcanvas-link"> Inicio</a>
                    <a href="arabes.html" class="offcanvas-link"> Perfumes √Årabes</a>
                    <a href="disenador.html" class="offcanvas-link active"> Dise√±ador</a>
                    <a href="proximo.html" class="offcanvas-link"> Pr√≥ximamente</a>
                    <a href="reservas.html" class="offcanvas-link"> Mis Reservas</a>
                </nav>
                <div class="offcanvas-footer">
                    <div class="small" style="color: rgba(4, 47, 38, 0.6); text-align: center;">
                        Fraganza ¬© 2025<br>Perfumer√≠a selecta
                    </div>
                </div>
            </div>
        </div>
        <section class="hero">
            <div class="left">
                <div class="eyebrow">Colecciones destacadas</div>
                <h1>Perfumes de Dise√±ador ‚Äî Elegancia contempor√°nea</h1>
                <p>Selecci√≥n cuidada de casas de moda: fragancias que combinan tradici√≥n y vanguardia, pensadas para
                    marcar presencia.</p>
                <div class="controls">
                    <select id="filter-type" class="select" aria-label="Filtrar por categor√≠a">
                        <option value="all">Todas las categor√≠as</option>
                    </select>
                    <select id="filter-price" class="select" aria-label="Ordenar por precio">
                        <option value="none">Ordenar por precio</option>
                        <option value="asc">Menor precio</option>
                        <option value="desc">Mayor precio</option>
                    </select>
                    <input type="text" id="search-input" class="search-input" placeholder="Buscar productos..."
                        aria-label="Buscar productos">
                    <button class="nav-cta" onclick="resetFilters()">Reset</button>
                </div>
            </div>
            <aside>
                <div class="premium-card" onclick="openPremiumModal()">
                    <div class="premium-image">
                        <img src="./Perfumes/Y Eau de Parfum Yves Saint Laurent.avif" alt="Y Eau de Parfum Yves Saint Laurent"
                            onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:16px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\'>BDC</div>'">
                    </div>
                    <div class="premium-badge">EDICI√ìN EXCLUSIVA</div>
                    <h3>Y Eau de Parfum Yves Saint Laurent</h3>
                    <p>De 6 a 12 horas en piel. En ropa 24+ horas.</p>
                    <div class="premium-price">$260000</div>
                    <button class="premium-cta" onclick="event.stopPropagation(); agregarPremiumAReservas();">Reservar
                        Ahora</button>
                </div>
            </aside>
        </section>
        <section style="margin-top:18px">
            <div class="grid" id="designer-grid"></div>
        </section>
        <div class="backdrop" id="backdrop">
            <div class="modal" role="dialog" aria-modal="true">
                <div>
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <h3 id="m-name">Nombre</h3>
                        <button class="close" onclick="closeModal()">‚úï</button>
                    </div>
                    <p id="m-desc" style="color:#225241"></p>
                    <div style="margin-top:12px">
                        <div id="m-price-container"></div>
                    </div>
                    <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap">
                        <button class="btn-reservar" onclick="reservarProducto()">Reservar ahora</button>
                        <button class="nav-link" onclick="closeModal()">Cerrar</button>
                    </div>
                </div>
                <div style="display:grid;place-items:center">
                    <div id="m-art"></div>
                </div>
            </div>
        </div>
        <footer>
            <div class="footer-grid footer">
                <div>
                    <h4>Fraganza</h4>
                    <p class="small" style="color:rgba(255,255,255,0.95)">Perfumer√≠a ¬∑ Autenticidad y selecci√≥n cuidada.
                        Blanco & Verde Oscuro.</p>
                    <div style="margin-top:10px">fraganzza.shop@gmail.com ¬∑ +54 9 358 9427 ¬∑ Cordoba</div>
                </div>
                <div>
                    <h4>Tienda</h4>
                    <a href="arabes.html">Perfumes √Årabes</a>
                    <a href="disenador.html">Perfumes de Dise√±ador</a>
                    <a href="proximo.html">Pr√≥ximamente</a>
                </div>
                <div>
                    <h4>Atenci√≥n al cliente</h4>
                    <a href="#">Env√≠os y devoluciones</a>
                    <a href="#">M√©todos de pago</a>
                    <a href="#">Preguntas frecuentes</a>
                    <a href="#">Contacto</a>
                </div>
                <div>
                    <h4>Legal</h4>
                    <a href="#">T√©rminos & Condiciones</a>
                    <a href="#">Pol√≠tica de privacidad</a>
                    <a href="#">Pol√≠tica de env√≠os</a>
                </div>
            </div>
            <div
                style="margin-top:18px;border-top:1px solid rgba(255,255,255,0.06);padding-top:14px;display:flex;justify-content:space-between;align-items:center">
                <div>¬© Fraganza 2025 ¬∑ Todos los derechos reservados</div>
                <div class="small" style="color:rgba(255,255,255,0.85)">Dise√±o: Fraganza ¬∑ Pagos seguros</div>
            </div>
        </footer>
    </div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB8W3Lf5Q8VY8Y6Y8Y6Y8Y6Y8Y6Y8Y6Y8Y6",
            authDomain: "inventario-fraganza.firebaseapp.com",
            projectId: "inventario-fraganza",
            storageBucket: "inventario-fraganza.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890abcdef"
        };

        let db;
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            db = firebase.firestore();
        } catch (error) {
            console.error("Error inicializando Firebase:", error);
        }

        const el = s => document.querySelector(s);
        const grid = el('#designer-grid');

        function money(n) { return '$' + n.toLocaleString('es-AR'); }

        let allDesignerProducts = [];
        let categories = new Set();
        let currentProduct = null;

        const DESCUENTO_GLOBAL = 25;

        const premiumProduct = {
            id: 'premium-disenador',
            name: "Y Eau de Parfum Yves Saint Laurent",
            desc: "Y Eau de Parfum de Yves Saint Laurent es una fragancia de la familia olfativa Arom√°tica Foug√®re para Hombres. Y Eau de Parfum se lanz√≥ en 2018. La Nariz detr√°s de esta fragrancia es Dominique Ropion. Las Notas de Salida son manzana, jengibre y bergamota; las Notas de Coraz√≥n son salvia, bayas de enebro y geranio; las Notas de Fondo son Amberwood, haba tonka, cedro, vetiver y incienso de ol√≠bano (franquincienso).",
            price: 260000,
            image: "Y Eau de Parfum Yves Saint Laurent.avif"
        };

        function actualizarContadorReservas() {
            const reservas = JSON.parse(localStorage.getItem('fraganza_reservas')) || [];
            const totalProductos = reservas.reduce((sum, p) => sum + p.cantidad, 0);
            el('#reserva-count').textContent = totalProductos;
        }

        function agregarAReservas(producto) {
            let reservas = JSON.parse(localStorage.getItem('fraganza_reservas')) || [];

            const productoExistente = reservas.find(p => p.id === producto.id);

            if (productoExistente) {
                productoExistente.cantidad += 1;
            } else {
                const precioConDescuento = producto.price * (1 - DESCUENTO_GLOBAL / 100);
                reservas.push({
                    id: producto.id,
                    name: producto.name + ` (${DESCUENTO_GLOBAL}% OFF)`,
                    price: Math.round(precioConDescuento),
                    desc: producto.desc || '',
                    image: producto.image || '',
                    cantidad: 1,
                    originalPrice: producto.price,
                    discount: DESCUENTO_GLOBAL
                });
            }

            localStorage.setItem('fraganza_reservas', JSON.stringify(reservas));
            actualizarContadorReservas();
            mostrarConfirmacionReserva(producto.name);
        }

        function mostrarConfirmacionReserva(nombreProducto) {
            const notificacion = document.createElement('div');
            notificacion.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: var(--green-dark);
                color: white;
                padding: 12px 18px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;

            notificacion.innerHTML = `
                ‚úÖ Agregado a reservas: ${nombreProducto} (${DESCUENTO_GLOBAL}% OFF)
                <br><small style="opacity:0.9">Ver en <a href="reservas.html" style="color:white;text-decoration:underline">Mis Reservas</a></small>
            `;

            document.body.appendChild(notificacion);

            setTimeout(() => {
                notificacion.remove();
            }, 3000);
        }

        function agregarPremiumAReservas() {
            agregarAReservas(premiumProduct);
        }

        function reservarProducto() {
            if (currentProduct) {
                agregarAReservas(currentProduct);
                closeModal();
            }
        }

        function openPremiumModal() {
            currentProduct = premiumProduct;
            el('#m-name').textContent = premiumProduct.name;
            el('#m-desc').textContent = premiumProduct.desc;

            const precioConDescuento = premiumProduct.price * (1 - DESCUENTO_GLOBAL / 100);
            const ahorro = premiumProduct.price - precioConDescuento;

            el('#m-price-container').innerHTML = `
                <div style="background:var(--discount-bg);padding:12px;border-radius:8px;border:1px solid rgba(5,150,105,0.1);">
                    <div style="color:#666;font-size:14px;text-decoration:line-through;">${money(premiumProduct.price)}</div>
                    <div style="font-size:24px;font-weight:900;color:var(--green-dark);">${money(Math.round(precioConDescuento))}</div>
                    <div style="color:var(--discount-green);font-size:13px;font-weight:700;margin-top:4px;">
                        Ahorras ${money(Math.round(ahorro))} (${DESCUENTO_GLOBAL}% OFF)
                    </div>
                </div>
            `;

            const mArt = el('#m-art');
            if (premiumProduct.image) {
                mArt.innerHTML = `<img src="${premiumProduct.image}" alt="${premiumProduct.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:28px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\\'>${premiumProduct.name.split(' ').slice(0, 2).join(' ')}</div>'">`;
                mArt.style.background = 'none';
                mArt.style.padding = '20px';
            } else {
                mArt.textContent = premiumProduct.name.split(' ').slice(0, 2).join(' ');
                mArt.style.background = 'linear-gradient(135deg,var(--green-dark),var(--green-mid))';
                mArt.style.display = 'flex';
                mArt.style.alignItems = 'center';
                mArt.style.justifyContent = 'center';
                mArt.style.color = '#fff';
                mArt.style.fontWeight = '900';
                mArt.style.fontSize = '28px';
                mArt.style.padding = '20px';
            }

            el('#backdrop').style.display = 'flex';
            el('#backdrop').setAttribute('aria-hidden', 'false');
            el('#backdrop').dataset.current = 'premium';
        }

        async function loadDesigners() {
            try {
                if (!db) {
                    console.error("Firebase no est√° inicializado");
                    return;
                }

                const snapshot = await db.collection('items')
                    .where('mainCategory', '==', 'Dise√±ador')
                    .get();

                allDesignerProducts = snapshot.docs.map(doc => {
                    const data = doc.data();
                    return {
                        id: doc.id,
                        name: data.name || 'Sin nombre',
                        notes: data.notes || [],
                        price: data.price || 0,
                        desc: data.description || '',
                        image: data.imageUrl || '',
                        category: data.category || 'Sin categor√≠a'
                    };
                });

                categories.clear();
                allDesignerProducts.forEach(product => {
                    if (product.category && product.category !== 'Sin categor√≠a') {
                        categories.add(product.category);
                    }
                });

                populateCategoryFilter();
                render(allDesignerProducts);
            } catch (error) {
                console.error("Error cargando productos de dise√±ador:", error);
            }
        }

        function populateCategoryFilter() {
            const filterType = el('#filter-type');
            if (!filterType) return;

            const currentValue = filterType.value;
            filterType.innerHTML = '<option value="all">Todas las categor√≠as</option>';

            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.toLowerCase();
                option.textContent = category;
                filterType.appendChild(option);
            });

            if (currentValue && currentValue !== 'all') {
                filterType.value = currentValue;
            }
        }

        function createCard(p) {
            const div = document.createElement('div');
            div.className = 'card';

            let imageContent;
            if (p.image) {
                imageContent = `<img src="${p.image}" alt="${p.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:18px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\'>${p.name.split(' ').map(w => w[0]).filter(char => char.match(/[A-Z]/)).slice(0, 2).join('')}</div>'">`;
            } else {
                const initials = p.name.split(' ').map(w => w[0]).filter(char => char.match(/[A-Z]/)).slice(0, 2).join('') || 'PF';
                imageContent = `<div style="width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:24px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))">${initials}</div>`;
            }

            const precioConDescuento = p.price * (1 - DESCUENTO_GLOBAL / 100);
            const ahorro = p.price - precioConDescuento;

            div.innerHTML = `
                <div class="discount-badge">‚ö° ${DESCUENTO_GLOBAL}% OFF</div>
                <div class="thumb">${imageContent}</div>
                <div class="meta">
                    <h3>${p.name}</h3>
                    <div class="price-container">
                        <span class="original-price">${money(p.price)}</span>
                        <span class="discounted-price">${money(Math.round(precioConDescuento))}</span>
                        <div class="savings">Ahorras ${money(Math.round(ahorro))}</div>
                    </div>
                </div>
            `;

            if (p.price > 0) {
                div.addEventListener('click', () => openModal(p));
            } else {
                div.style.cursor = 'default';
                div.style.opacity = '0.7';
            }

            return div;
        }

        function render(list) {
            if (!grid) return;
            grid.innerHTML = '';
            list.forEach(p => grid.appendChild(createCard(p)));
        }

        if (el('#filter-type')) {
            el('#filter-type').addEventListener('change', applyFilters);
        }
        if (el('#filter-price')) {
            el('#filter-price').addEventListener('change', applyFilters);
        }
        if (el('#search-input')) {
            el('#search-input').addEventListener('input', applyFilters);
        }

        function applyFilters() {
            let filteredList = [...allDesignerProducts];

            const categoryFilter = el('#filter-type').value;
            if (categoryFilter !== 'all') {
                filteredList = filteredList.filter(p =>
                    p.category && p.category.toLowerCase().includes(categoryFilter)
                );
            }

            const searchTerm = el('#search-input').value.toLowerCase();
            if (searchTerm) {
                filteredList = filteredList.filter(p =>
                    p.name.toLowerCase().includes(searchTerm) ||
                    (p.desc && p.desc.toLowerCase().includes(searchTerm)) ||
                    (p.category && p.category.toLowerCase().includes(searchTerm))
                );
            }

            const priceOrder = el('#filter-price').value;
            if (priceOrder === 'asc') {
                filteredList.sort((a, b) => (a.price * (1 - DESCUENTO_GLOBAL / 100)) - (b.price * (1 - DESCUENTO_GLOBAL / 100)));
            } else if (priceOrder === 'desc') {
                filteredList.sort((a, b) => (b.price * (1 - DESCUENTO_GLOBAL / 100)) - (a.price * (1 - DESCUENTO_GLOBAL / 100)));
            }

            render(filteredList);
        }

        function resetFilters() {
            if (el('#filter-type')) el('#filter-type').value = 'all';
            if (el('#filter-price')) el('#filter-price').value = 'none';
            if (el('#search-input')) el('#search-input').value = '';
            render(allDesignerProducts);
        }

        const backdrop = el('#backdrop');
        function openModal(p) {
            currentProduct = p;
            el('#m-name').textContent = p.name;
            el('#m-desc').textContent = p.desc || 'Descripci√≥n no disponible';

            const precioConDescuento = p.price * (1 - DESCUENTO_GLOBAL / 100);
            const ahorro = p.price - precioConDescuento;

            el('#m-price-container').innerHTML = `
                <div style="background:var(--discount-bg);padding:12px;border-radius:8px;border:1px solid rgba(5,150,105,0.1);">
                    <div style="color:#666;font-size:14px;text-decoration:line-through;">${money(p.price)}</div>
                    <div style="font-size:24px;font-weight:900;color:var(--green-dark);">${money(Math.round(precioConDescuento))}</div>
                    <div style="color:var(--discount-green);font-size:13px;font-weight:700;margin-top:4px;">
                        Ahorras ${money(Math.round(ahorro))} (${DESCUENTO_GLOBAL}% OFF)
                    </div>
                </div>
            `;

            const mArt = el('#m-art');
            if (p.image) {
                mArt.innerHTML = `<img src="${p.image}" alt="${p.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:28px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\\'>${p.name.split(' ').slice(0, 2).join(' ')}</div>'">`;
                mArt.style.background = 'none';
                mArt.style.padding = '20px';
            } else {
                mArt.textContent = p.name.split(' ').slice(0, 2).join(' ');
                mArt.style.background = 'linear-gradient(135deg,var(--green-dark),var(--green-mid))';
                mArt.style.display = 'flex';
                mArt.style.alignItems = 'center';
                mArt.style.justifyContent = 'center';
                mArt.style.color = '#fff';
                mArt.style.fontWeight = '900';
                mArt.style.fontSize = '28px';
                mArt.style.padding = '20px';
            }

            backdrop.style.display = 'flex';
            backdrop.setAttribute('aria-hidden', 'false');
            backdrop.dataset.current = p.id;
        }

        function closeModal() {
            backdrop.style.display = 'none';
            backdrop.setAttribute('aria-hidden', 'true');
            backdrop.dataset.current = '';
            currentProduct = null;
        }

        function toggleOffcanvas() {
            const oc = el('#offcanvas');
            if (oc.classList.contains('show')) {
                oc.classList.remove('show');
                setTimeout(() => {
                    oc.style.display = 'none';
                }, 300);
            } else {
                oc.style.display = 'block';
                setTimeout(() => {
                    oc.classList.add('show');
                }, 10);
            }
        }

        if (db) {
            loadDesigners();
        }
        actualizarContadorReservas();

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        backdrop.addEventListener('click', (e) => {
            if (e.target === backdrop) closeModal();
        });
    </script>
</body>

</html>