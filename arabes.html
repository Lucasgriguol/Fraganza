<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fraganza ‚Äî Perfumes √Årabes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&family=Playfair+Display:wght@400;700&display=swap"
    rel="stylesheet">
  <meta name="description" content="Colecci√≥n de perfumes √°rabes en Fraganza. Oud, √°mbar y rosas intensas." />
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <style>
    :root {
      --green-dark: #042f26;
      --green-mid: #0b6a55;
      --white: #ffffff;
      --muted: #eef6f3;
      --glass: rgba(255, 255, 255, 0.06);
      --accent: rgba(4, 47, 38, 0.06);
      --radius: 18px;
      --shadow: 0 20px 60px rgba(4, 47, 38, 0.12);
      --maxw: 1200px;
      --transition: 360ms cubic-bezier(.2, .9, .25, 1);
      --nav-height: 76px;
      --discount-green: #059669;
      --discount-bg: rgba(5, 150, 105, 0.08);
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      font-family: Montserrat, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background: linear-gradient(180deg, var(--muted), var(--white));
      color: var(--green-dark);
      line-height: 1.45;
      font-size: 15px
    }

    .wrap {
      max-width: var(--maxw);
      margin: 18px auto;
      padding: 18px
    }

    .navbar-wrap {
      position: sticky;
      top: 12px;
      z-index: 60
    }

    .navbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 20px;
      padding: 12px 18px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), var(--white));
      box-shadow: 0 20px 60px rgba(4, 47, 38, 0.06);
      height: var(--nav-height)
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px
    }

    .logo {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      display: grid;
      place-items: center;
      color: var(--white);
      font-family: 'Playfair Display';
      font-size: 22px;
      font-weight: 700;
      box-shadow: 0 8px 30px rgba(4, 47, 38, 0.18)
    }

    .brand h1 {
      margin: 0;
      font-size: 18px
    }

    .brand p {
      margin: 0;
      font-size: 12px;
      color: #1f5146
    }

    .nav-center {
      display: flex;
      gap: 8px;
      align-items: center
    }

    .nav-link {
      position: relative;
      padding: 10px 14px;
      border-radius: 10px;
      color: var(--green-dark);
      text-decoration: none;
      font-weight: 700;
      cursor: pointer
    }

    .nav-link:hover {
      background: var(--accent);
      transform: translateY(-4px)
    }

    .nav-cta {
      background: var(--green-dark);
      color: var(--white);
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 800
    }

    .nav-reserva {
      background: var(--green-dark);
      color: var(--white);
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 800
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px
    }

    .icon-btn {
      background: transparent;
      border: 0;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      color: var(--green-dark)
    }

    .mobile-toggle {
      display: none
    }

    .hero {
      margin-top: 18px;
      padding: 22px;
      border-radius: 12px;
      background: linear-gradient(180deg, var(--white), var(--white));
      box-shadow: 0 8px 30px rgba(4, 47, 38, 0.04);
      display: flex;
      gap: 18px;
      align-items: flex-start
    }

    .hero .left {
      flex: 1
    }

    .eyebrow {
      font-weight: 800;
      color: var(--green-mid);
      letter-spacing: 0.6px
    }

    .hero h1 {
      font-family: 'Playfair Display';
      margin: 0 0 8px;
      font-size: 32px;
      color: var(--green-dark)
    }

    .hero p {
      margin: 0;
      color: #1e5346
    }

    .controls {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 14px;
      flex-wrap: wrap;
    }

    .select,
    .btn-filter,
    .search-input {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(4, 47, 38, 0.06);
      background: var(--white);
      cursor: pointer;
      font-family: inherit;
      font-size: 14px;
    }

    .search-input {
      flex: 1;
      min-width: 200px;
      cursor: text;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--green-mid);
    }

    .btn-filter {
      background: linear-gradient(90deg, var(--green-dark), var(--green-mid));
      color: #fff;
      border: 0
    }

    .premium-card {
      background: linear-gradient(135deg, var(--white), #f7fff8);
      border-radius: 12px;
      padding: 16px;
      color: var(--green-dark);
      box-shadow: 0 12px 40px rgba(4, 47, 38, 0.15);
      border: 1px solid rgba(4, 47, 38, 0.08);
      width: 280px;
      cursor: pointer;
      transition: var(--transition);
    }

    .premium-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 48px rgba(4, 47, 38, 0.18);
    }

    .premium-image {
      width: 100%;
      height: 120px;
      border-radius: 8px;
      margin-bottom: 12px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .premium-image img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      border-radius: 6px;
    }

    .premium-badge {
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      color: var(--white);
      padding: 4px 10px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: 800;
      display: inline-block;
      margin-bottom: 8px;
    }

    .premium-card h3 {
      margin: 0 0 6px;
      font-size: 16px;
      color: var(--green-dark);
      font-family: 'Playfair Display';
      font-weight: 700;
    }

    .premium-card p {
      margin: 0 0 12px;
      color: #225241;
      font-size: 13px;
      line-height: 1.4;
    }

    .premium-price {
      font-size: 18px;
      font-weight: 800;
      color: var(--green-dark);
      margin-bottom: 10px;
    }

    .premium-cta {
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      color: var(--white);
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      font-size: 13px;
      transition: var(--transition);
    }

    .premium-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(4, 47, 38, 0.2);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 18px;
      margin-top: 18px
    }

    .card {
      background: linear-gradient(180deg, var(--white), #fbfffb);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(4, 47, 38, 0.03);
      box-shadow: 0 8px 28px rgba(4, 47, 38, 0.04);
      transition: var(--transition);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-8px)
    }

    .discount-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: 900;
      font-size: 12px;
      z-index: 2;
      box-shadow: 0 4px 12px rgba(4, 47, 38, 0.2);
      display: flex;
      align-items: center;
      gap: 4px;
      min-width: 70px;
      justify-content: center;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .thumb {
      height: 200px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 900;
      font-size: 24px;
      overflow: hidden;
      padding: 10px;
    }

    .thumb img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      border-radius: 8px;
    }

    .meta {
      margin-top: 10px
    }

    .meta h3 {
      margin: 0;
      color: var(--green-dark);
      font-size: 16px;
      line-height: 1.3;
    }

    .meta p {
      margin: 8px 0 0;
      color: #225241;
      font-size: 14px;
      line-height: 1.4;
    }

    .price-container {
      margin-top: 8px;
      padding: 8px;
      background: var(--discount-bg);
      border-radius: 8px;
      border: 1px solid rgba(5, 150, 105, 0.1);
    }

    .original-price {
      color: #666;
      font-size: 12px;
      text-decoration: line-through;
      display: block;
      margin-bottom: 2px;
    }

    .discounted-price {
      font-size: 18px;
      font-weight: 900;
      color: var(--green-dark);
      display: block;
      line-height: 1.2;
    }

    .savings {
      font-size: 11px;
      color: var(--discount-green);
      font-weight: 700;
      margin-top: 2px;
    }

    .backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2, 15, 12, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 80
    }

    .modal {
      background: var(--white);
      width: min(860px, 94%);
      border-radius: 12px;
      padding: 18px;
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 12px
    }

    .close {
      background: transparent;
      border: 0;
      font-size: 18px;
      cursor: pointer;
      color: var(--green-dark)
    }

    #m-art {
      width: 100%;
      height: 320px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 900;
      font-size: 28px;
      overflow: hidden;
      padding: 20px;
    }

    #m-art img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      border-radius: 8px;
    }

    .btn-reservar {
      background: linear-gradient(135deg, var(--green-dark), var(--green-mid));
      color: var(--white);
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
    }

    .btn-reservar:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(4, 47, 38, 0.3);
    }

    footer {
      margin-top: 28px;
      border-radius: 12px;
      padding: 28px;
      background: linear-gradient(180deg, var(--green-dark), var(--green-mid));
      color: var(--white);
      box-shadow: 0 30px 80px rgba(4, 47, 38, 0.18)
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 18px
    }

    .footer a {
      color: rgba(255, 255, 255, 0.95);
      text-decoration: none
    }

    @media (max-width:980px) {
      .hero {
        flex-direction: column
      }

      .modal {
        grid-template-columns: 1fr
      }

      .nav-center {
        display: none
      }

      .mobile-toggle {
        display: block
      }

      .footer-grid {
        grid-template-columns: repeat(2, 1fr)
      }

      .controls {
        flex-direction: column;
        align-items: stretch;
      }

      .search-input {
        min-width: auto;
      }

      .premium-card {
        width: 100%;
        max-width: 320px;
        margin: 0 auto;
      }
    }

    @media (max-width:640px) {
      .hero h1 {
        font-size: 28px
      }

      .grid {
        grid-template-columns: 1fr
      }
    }

    .small {
      font-size: 13px
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="navbar-wrap">
      <div class="navbar">
        <div style="display:flex;align-items:center;gap:12px">
          <button class="mobile-toggle icon-btn" aria-label="Abrir men√∫" onclick="toggleOffcanvas()">‚ò∞</button>
          <div class="brand">
            <img class="logo" src="IMG-20251110-WA0007.jpg" alt="">
            <div>
              <h1>Fraganza</h1>
              <p class="small">Perfumer√≠a selecta</p>
            </div>
          </div>
        </div>

        <div class="nav-center" role="navigation" aria-label="Navegaci√≥n principal">
          <a class="nav-link" href="index.html">Inicio</a>
          <a class="nav-link" href="arabes.html">Perfumes √Årabes</a>
          <a class="nav-link" href="disenador.html">Dise√±ador</a>
          <a class="nav-link" href="proximo.html">Pr√≥ximamente</a>
          <a class="nav-link nav-reserva" href="reservas.html">Mis Reservas</a>
        </div>

        <div class="nav-right">
          <div class="reserva-indicator">
            <button class="icon-btn" aria-label="Ver reservas" onclick="window.location.href='reservas.html'">üìã <span
                class="reserva-count" id="reserva-count">0</span></button>
          </div>
        </div>
      </div>
    </div>

    <div id="offcanvas" style="position:fixed;inset:0;background:rgba(0,0,0,0.4);display:none;z-index:90">
      <div style="width:300px;height:100%;background:var(--white);padding:18px">
        <div style="display:flex;justify-content:space-between;align-items:center"><strong>Men√∫</strong><button
            onclick="toggleOffcanvas()" class="icon-btn">‚úï</button></div>
        <nav style="margin-top:18px;display:flex;flex-direction:column;gap:8px">
          <a href="index.html">Inicio</a>
          <a href="arabes.html">Perfumes √Årabes</a>
          <a href="disenador.html">Dise√±ador</a>
          <a href="proximo.html">Pr√≥ximamente</a>
          <a href="reservas.html" style="color:var(--green-dark);font-weight:800">Mis Reservas</a>
        </nav>
      </div>
    </div>

    <section class="hero">
      <div class="left">
        <div class="eyebrow" style="font-weight:800;color:var(--green-mid);letter-spacing:0.6px">Colecciones
          destacadas</div>
        <h1>Perfumes √Årabes ‚Äî Intensidad y tradici√≥n</h1>
        <p>Selecci√≥n de fragancias orientales: oud, √°mbar, rosa y resinas. Perfumes con car√°cter, pensados para
          durar y dejar huella.</p>

        <div class="controls">
          <select id="filter-type" class="select" aria-label="Filtrar por categor√≠a">
            <option value="all">Todas las categor√≠as</option>
          </select>
          <select id="filter-price" class="select" aria-label="Ordenar por precio">
            <option value="none">Ordenar por precio</option>
            <option value="asc">Menor precio</option>
            <option value="desc">Mayor precio</option>
          </select>
          <input type="text" id="search-input" class="search-input" placeholder="Buscar productos..."
            aria-label="Buscar productos">
          <button class="nav-cta" onclick="resetFilters()">Reset</button>
        </div>
      </div>

      <aside>
        <div class="premium-card" onclick="openPremiumModal()">
          <div class="premium-image">
            <img src="Liquid Brun French Avenue.avif" alt="Liquid Brun French Avenue "
              onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:16px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\'>AOG</div>'">
          </div>
          <div class="premium-badge">EDICI√ìN EXCLUSIVA</div>
          <h3>Liquid Brun French Avenue</h3>
          <p>12 a 36 horas de uso real. Alta duraci√≥n.</p>

          <div class="premium-price">$95000</div>
          <button class="premium-cta" onclick="event.stopPropagation(); agregarPremiumAReservas();">Reservar
            Ahora</button>
        </div>
      </aside>
    </section>

    <section style="margin-top:18px">
      <div class="grid" id="arab-grid"></div>
    </section>

    <div class="backdrop" id="backdrop">
      <div class="modal" role="dialog" aria-modal="true">
        <div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 id="m-name">Nombre</h3>
            <button class="close" onclick="closeModal()">‚úï</button>
          </div>
          <p id="m-desc" style="color:#225241"></p>
          <div style="margin-top:12px">
            <div id="m-price-container"></div>
          </div>
          <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn-reservar" onclick="reservarProducto()">Reservar ahora</button>
            <button class="nav-link" onclick="closeModal()">Cerrar</button>
          </div>
        </div>
        <div style="display:grid;place-items:center">
          <div id="m-art"></div>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer-grid footer">
        <div>
          <h4>Fraganza</h4>
          <p class="small" style="color:rgba(255,255,255,0.95)">Perfumer√≠a ¬∑ Autenticidad y selecci√≥n cuidada.
            Blanco & Verde Oscuro.</p>
          <div style="margin-top:10px">ventas@fraganza.example ¬∑ +54 9 11 1234 5678</div>
        </div>
        <div>
          <h4>Tienda</h4>
          <a href="arabes.html">Perfumes √Årabes</a>
          <a href="disenador.html">Perfumes de Dise√±ador</a>
          <a href="proximo.html">Pr√≥ximamente</a>
        </div>
        <div>
          <h4>Atenci√≥n al cliente</h4>
          <a href="#">Env√≠os y devoluciones</a>
          <a href="#">M√©todos de pago</a>
          <a href="#">Preguntas frecuentes</a>
          <a href="#">Contacto</a>
        </div>
        <div>
          <h4>Legal</h4>
          <a href="#">T√©rminos & Condiciones</a>
          <a href="#">Pol√≠tica de privacidad</a>
          <a href="#">Pol√≠tica de env√≠os</a>
        </div>
      </div>

      <div
        style="margin-top:18px;border-top:1px solid rgba(255,255,255,0.06);padding-top:14px;display:flex;justify-content:space-between;align-items:center">
        <div>¬© Fraganza 2025 ¬∑ Todos los derechos reservados</div>
        <div class="small" style="color:rgba(255,255,255,0.85)">Dise√±o: Fraganza ¬∑ Pagos seguros</div>
      </div>
    </footer>

  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB8W3Lf5Q8VY8Y6Y8Y6Y8Y6Y8Y6Y8Y6Y8Y6",
      authDomain: "inventario-fraganza.firebaseapp.com",
      projectId: "inventario-fraganza",
      storageBucket: "inventario-fraganza.appspot.com",
      messagingSenderId: "123456789012",
      appId: "1:123456789012:web:abcdef1234567890abcdef"
    };

    let db;
    try {
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
      db = firebase.firestore();
      console.log("Firebase inicializado correctamente");
    } catch (error) {
      console.error("Error inicializando Firebase:", error);
    }

    const el = s => document.querySelector(s);
    const grid = el('#arab-grid');

    function money(n) { return '$' + n.toLocaleString('es-AR'); }

    let allArabProducts = [];
    let categories = new Set();
    let currentProduct = null;

    const DESCUENTO_GLOBAL = 25;

    const premiumProduct = {
      id: 'premium-arabe',
      name: "Liquid Brun French Avenue ",
      desc: "Liquid Brun de French Avenue es una fragancia de la familia olfativa Amaderada para Hombres. Esta fragrancia es nueva. Liquid Brun se lanz√≥ en 2024. Las Notas de Salida son canela, flor de azahar del naranjo, cardamomo y bergamota; las Notas de Coraz√≥n son vainilla Bourbon y elem√≠; las Notas de Fondo son pralin√©, ambroxan, madera de gaiac y almizcle.",
      price: 95000,
      image: "Liquid Brun French Avenue.avif"
    };

    function actualizarContadorReservas() {
      const reservas = JSON.parse(localStorage.getItem('fraganza_reservas')) || [];
      const totalProductos = reservas.reduce((sum, p) => sum + p.cantidad, 0);
      el('#reserva-count').textContent = totalProductos;
    }

    function agregarAReservas(producto) {
      let reservas = JSON.parse(localStorage.getItem('fraganza_reservas')) || [];

      const productoExistente = reservas.find(p => p.id === producto.id);

      if (productoExistente) {
        productoExistente.cantidad += 1;
      } else {
        const precioConDescuento = producto.price * (1 - DESCUENTO_GLOBAL / 100);
        reservas.push({
          id: producto.id,
          name: producto.name + ` (${DESCUENTO_GLOBAL}% OFF)`,
          price: Math.round(precioConDescuento),
          desc: producto.desc || '',
          image: producto.image || '',
          cantidad: 1,
          originalPrice: producto.price,
          discount: DESCUENTO_GLOBAL
        });
      }

      localStorage.setItem('fraganza_reservas', JSON.stringify(reservas));
      actualizarContadorReservas();
      mostrarConfirmacionReserva(producto.name);
    }

    function mostrarConfirmacionReserva(nombreProducto) {
      const notificacion = document.createElement('div');
      notificacion.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: var(--green-dark);
        color: white;
        padding: 12px 18px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        font-weight: 600;
      `;

      notificacion.innerHTML = `
        ‚úÖ Agregado a reservas: ${nombreProducto} (${DESCUENTO_GLOBAL}% OFF)
        <br><small style="opacity:0.9">Ver en <a href="reservas.html" style="color:white;text-decoration:underline">Mis Reservas</a></small>
      `;

      document.body.appendChild(notificacion);

      setTimeout(() => {
        notificacion.remove();
      }, 3000);
    }

    function agregarPremiumAReservas() {
      agregarAReservas(premiumProduct);
    }

    function reservarProducto() {
      if (currentProduct) {
        agregarAReservas(currentProduct);
        closeModal();
      }
    }

    function openPremiumModal() {
      currentProduct = premiumProduct;
      el('#m-name').textContent = premiumProduct.name;
      el('#m-desc').textContent = premiumProduct.desc;

      const precioConDescuento = premiumProduct.price * (1 - DESCUENTO_GLOBAL / 100);
      const ahorro = premiumProduct.price - precioConDescuento;

      el('#m-price-container').innerHTML = `
        <div style="background:var(--discount-bg);padding:12px;border-radius:8px;border:1px solid rgba(5,150,105,0.1);">
          <div style="color:#666;font-size:14px;text-decoration:line-through;">${money(premiumProduct.price)}</div>
          <div style="font-size:24px;font-weight:900;color:var(--green-dark);">${money(Math.round(precioConDescuento))}</div>
          <div style="color:var(--discount-green);font-size:13px;font-weight:700;margin-top:4px;">
            Ahorras ${money(Math.round(ahorro))} (${DESCUENTO_GLOBAL}% OFF)
          </div>
        </div>
      `;

      const mArt = el('#m-art');
      if (premiumProduct.image) {
        mArt.innerHTML = `<img src="${premiumProduct.image}" alt="${premiumProduct.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:28px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\\'>${premiumProduct.name.split(' ').slice(0, 2).join(' ')}</div>'">`;
        mArt.style.background = 'none';
        mArt.style.padding = '20px';
      } else {
        mArt.textContent = premiumProduct.name.split(' ').slice(0, 2).join(' ');
        mArt.style.background = 'linear-gradient(135deg,var(--green-dark),var(--green-mid))';
        mArt.style.display = 'flex';
        mArt.style.alignItems = 'center';
        mArt.style.justifyContent = 'center';
        mArt.style.color = '#fff';
        mArt.style.fontWeight = '900';
        mArt.style.fontSize = '28px';
        mArt.style.padding = '20px';
      }

      el('#backdrop').style.display = 'flex';
      el('#backdrop').setAttribute('aria-hidden', 'false');
      el('#backdrop').dataset.current = 'premium';
    }

    async function loadArabes() {
      try {
        if (!db) {
          console.error("Firebase no est√° inicializado");
          return;
        }

        console.log("Cargando perfumes √°rabes...");

        const snapshot = await db.collection('items')
          .where('mainCategory', '==', 'Arabe')
          .get();

        console.log("Perfumes √°rabes encontrados:", snapshot.size);

        allArabProducts = snapshot.docs.map(doc => {
          const data = doc.data();
          return {
            id: doc.id,
            name: data.name || 'Sin nombre',
            notes: data.notes || [],
            price: data.price || 0,
            desc: data.description || '',
            image: data.imageUrl || '',
            category: data.category || 'Sin categor√≠a'
          };
        });

        categories.clear();
        allArabProducts.forEach(product => {
          if (product.category && product.category !== 'Sin categor√≠a') {
            categories.add(product.category);
          }
        });

        populateCategoryFilter();
        render(allArabProducts);
      } catch (error) {
        console.error("Error cargando productos √°rabes:", error);
      }
    }

    function populateCategoryFilter() {
      const filterType = el('#filter-type');
      if (!filterType) return;

      const currentValue = filterType.value;
      filterType.innerHTML = '<option value="all">Todas las categor√≠as</option>';

      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category.toLowerCase();
        option.textContent = category;
        filterType.appendChild(option);
      });

      if (currentValue && currentValue !== 'all') {
        filterType.value = currentValue;
      }
    }

    function createCard(p) {
      const div = document.createElement('div');
      div.className = 'card';

      let imageContent;
      if (p.image) {
        imageContent = `<img src="${p.image}" alt="${p.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:18px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\'>${p.name.split(' ').map(w => w[0]).filter(char => char.match(/[A-Z]/)).slice(0, 2).join('')}</div>'">`;
      } else {
        const initials = p.name.split(' ').map(w => w[0]).filter(char => char.match(/[A-Z]/)).slice(0, 2).join('') || 'PF';
        imageContent = `<div style="width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:24px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))">${initials}</div>`;
      }

      const precioConDescuento = p.price * (1 - DESCUENTO_GLOBAL / 100);
      const ahorro = p.price - precioConDescuento;

      div.innerHTML = `
        <div class="discount-badge">‚ö° ${DESCUENTO_GLOBAL}% OFF</div>
        <div class="thumb">${imageContent}</div>
        <div class="meta">
          <h3>${p.name}</h3>
          <div class="price-container">
            <span class="original-price">${money(p.price)}</span>
            <span class="discounted-price">${money(Math.round(precioConDescuento))}</span>
            <div class="savings">Ahorras ${money(Math.round(ahorro))}</div>
          </div>
        </div>
      `;

      if (p.price > 0) {
        div.addEventListener('click', () => openModal(p));
      } else {
        div.style.cursor = 'default';
        div.style.opacity = '0.7';
      }

      return div;
    }

    function render(list) {
      if (!grid) return;
      grid.innerHTML = '';
      list.forEach(p => grid.appendChild(createCard(p)));
    }

    if (el('#filter-type')) {
      el('#filter-type').addEventListener('change', applyFilters);
    }
    if (el('#filter-price')) {
      el('#filter-price').addEventListener('change', applyFilters);
    }
    if (el('#search-input')) {
      el('#search-input').addEventListener('input', applyFilters);
    }

    function applyFilters() {
      let filteredList = [...allArabProducts];

      const categoryFilter = el('#filter-type').value;
      if (categoryFilter !== 'all') {
        filteredList = filteredList.filter(p =>
          p.category && p.category.toLowerCase().includes(categoryFilter)
        );
      }

      const searchTerm = el('#search-input').value.toLowerCase();
      if (searchTerm) {
        filteredList = filteredList.filter(p =>
          p.name.toLowerCase().includes(searchTerm) ||
          (p.desc && p.desc.toLowerCase().includes(searchTerm)) ||
          (p.category && p.category.toLowerCase().includes(searchTerm))
        );
      }

      const priceOrder = el('#filter-price').value;
      if (priceOrder === 'asc') {
        filteredList.sort((a, b) => (a.price * (1 - DESCUENTO_GLOBAL / 100)) - (b.price * (1 - DESCUENTO_GLOBAL / 100)));
      } else if (priceOrder === 'desc') {
        filteredList.sort((a, b) => (b.price * (1 - DESCUENTO_GLOBAL / 100)) - (a.price * (1 - DESCUENTO_GLOBAL / 100)));
      }

      render(filteredList);
    }

    function resetFilters() {
      if (el('#filter-type')) el('#filter-type').value = 'all';
      if (el('#filter-price')) el('#filter-price').value = 'none';
      if (el('#search-input')) el('#search-input').value = '';
      render(allArabProducts);
    }

    const backdrop = el('#backdrop');
    function openModal(p) {
      currentProduct = p;
      el('#m-name').textContent = p.name;
      el('#m-desc').textContent = p.desc || 'Descripci√≥n no disponible';

      const precioConDescuento = p.price * (1 - DESCUENTO_GLOBAL / 100);
      const ahorro = p.price - precioConDescuento;

      el('#m-price-container').innerHTML = `
        <div style="background:var(--discount-bg);padding:12px;border-radius:8px;border:1px solid rgba(5,150,105,0.1);">
          <div style="color:#666;font-size:14px;text-decoration:line-through;">${money(p.price)}</div>
          <div style="font-size:24px;font-weight:900;color:var(--green-dark);">${money(Math.round(precioConDescuento))}</div>
          <div style="color:var(--discount-green);font-size:13px;font-weight:700;margin-top:4px;">
            Ahorras ${money(Math.round(ahorro))} (${DESCUENTO_GLOBAL}% OFF)
          </div>
        </div>
      `;

      const mArt = el('#m-art');
      if (p.image) {
        mArt.innerHTML = `<img src="${p.image}" alt="${p.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div style=\\'width:100%;height:100%;display:grid;place-items:center;color:#fff;font-weight:900;font-size:28px;background:linear-gradient(135deg,var(--green-dark),var(--green-mid))\\'>${p.name.split(' ').slice(0, 2).join(' ')}</div>'">`;
        mArt.style.background = 'none';
        mArt.style.padding = '20px';
      } else {
        mArt.textContent = p.name.split(' ').slice(0, 2).join(' ');
        mArt.style.background = 'linear-gradient(135deg,var(--green-dark),var(--green-mid))';
        mArt.style.display = 'flex';
        mArt.style.alignItems = 'center';
        mArt.style.justifyContent = 'center';
        mArt.style.color = '#fff';
        mArt.style.fontWeight = '900';
        mArt.style.fontSize = '28px';
        mArt.style.padding = '20px';
      }

      backdrop.style.display = 'flex';
      backdrop.setAttribute('aria-hidden', 'false');
      backdrop.dataset.current = p.id;
    }

    function closeModal() {
      backdrop.style.display = 'none';
      backdrop.setAttribute('aria-hidden', 'true');
      backdrop.dataset.current = '';
      currentProduct = null;
    }

    function toggleOffcanvas() {
      const oc = el('#offcanvas');
      oc.style.display = oc.style.display === 'block' ? 'none' : 'block';
    }

    if (db) {
      loadArabes();
    }
    actualizarContadorReservas();

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    backdrop.addEventListener('click', (e) => {
      if (e.target === backdrop) closeModal();
    });
  </script>
</body>

</html>